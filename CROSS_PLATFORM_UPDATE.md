# 跨平台和多密钥支持更新

## 🎉 新增功能

### 🔐 跨平台支持
- **自动平台检测**: 支持Windows、macOS、Linux系统
- **路径规范化**: 自动处理不同操作系统的路径分隔符
- **默认SSH密钥位置**: 自动检测常见SSH密钥存储位置
- **系统级密钥支持**: Linux系统支持/etc/ssh系统密钥

### 🔑 多密钥管理
- **多密钥存储**: 支持每个服务器存储10个不同的SSH密钥
- **密钥选择界面**: 直观的可视化密钥选择器
- **自动密钥检测**: 自动扫描并显示可用的SSH密钥
- **密钥浏览**: 支持从文件系统选择自定义密钥文件
- **密钥验证**: 严格的SSH密钥格式验证

### 🛡️ 增强的认证流程
- **智能认证**: 自动尝试检测到的SSH密钥
- **密码备选**: 支持密码和密钥两种认证方式
- **安全存储**: 使用VSCode SecretStorage API安全存储
- **凭据管理**: 完整的凭据增删改查界面

## 🚀 技术实现

### 新增文件
- `src/utils/PlatformUtils.ts` - 跨平台工具类
  - 平台检测和路径处理
  - SSH密钥自动检测
  - 配置文件解析
  - 文件权限检查

### 核心改进
- `src/security/CredentialManager.ts` - 增强的凭据管理器
  - 多密钥存储和管理
  - 跨平台SSH密钥检测
  - 安全的凭据验证

### 用户界面
- `src/ui/ConfigurationPanel.ts` - 现代化配置面板
  - 直观的密钥管理界面
  - 智能认证方法选择
  - 完整的凭据生命周期管理

## 🎨 用户体验

### 密钥管理界面
1. **浏览可用密钥**: 自动检测并列出所有可用的SSH密钥
2. **密钥详情显示**: 显示密钥类型、路径、描述
3. **添加新密钥**: 支持浏览选择本地密钥文件
4. **删除管理**: 安全删除不再使用的密钥
5. **密钥预览**: 显示密钥内容预览（前几行）

### 配置优化
- **智能默认值**: 根据平台设置合理的默认配置
- **验证提示**: 实时的配置验证和错误提示
- **跨平台兼容**: 确保在所有主流系统上正常工作

## 📋 支持的密钥格式
- **RSA**: `id_rsa`, `id_rsa.pem`
- **Ed25519**: `id_ed25519`, `id_ed25519.pem`
- **ECDSA**: `id_ecdsa`, `id_ecdsa.pem`
- **DSA**: `id_dsa` (兼容性)
- **OpenSSH**: `id_rsa` (OpenSSH格式)
- **PKCS#8**: `.pem`, `.key` 格式

## 🔧 使用方法

### 密钥管理
1. 打开命令面板: `Ctrl+Shift+P`
2. 选择: `vscode-scp: Config` → `Manage Credentials`
3. 选择操作:
   - `Browse for SSH Key File` - 浏览选择密钥文件
   - `Add New SSH Key` - 添加新的SSH密钥
   - `Detect Available Keys` - 重新检测可用密钥
   - `Manage Stored Keys` - 管理已存储的密钥

### 自动检测
- 扩展会自动扫描以下位置的SSH密钥:
  - `~/.ssh/` (用户目录)
  - `/etc/ssh/` (系统目录，仅Linux)
  - 支持所有主流密钥格式

### 安全特性
- 所有密钥内容经过严格验证
- 敏感信息使用VSCode SecretStorage加密存储
- 支持密钥文件格式验证
- 安全的路径处理和文件访问

## 📦 文件结构更新
```
src/utils/PlatformUtils.ts     # 新增：跨平台工具
src/security/CredentialManager.ts  # 重构：多密钥管理
src/ui/ConfigurationPanel.ts     # 更新：密钥管理界面
```

这些更新确保VSCode SCP插件在各种操作系统和复杂的企业环境中都能稳定工作，提供企业级的多密钥管理能力。